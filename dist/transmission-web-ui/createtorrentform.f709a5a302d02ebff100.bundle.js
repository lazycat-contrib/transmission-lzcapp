"use strict";(self.webpackChunktrguing=self.webpackChunktrguing||[]).push([[908],{6404:(e,t,r)=>{r.a(e,(async(e,s)=>{try{r.r(t),r.d(t,{default:()=>k});var a=r(6972),n=r(3515),o=r(1972),i=r(61),l=r(2691),c=r(5918),u=r(8860),h=r(391),d=r(1938),p=r(1425),f=r(6848),v=r(4292),m=r(7294),b=r(1739),g=r(6716),S=e([b]);b=(S.then?(await S)():S)[0];const{appWindow:y,invoke:T}=await r.e(457).then(r.bind(r,4637)),w={root:{flexGrow:1,display:"flex",flexDirection:"column"},wrapper:{flexGrow:1},input:{height:"100%"}},C=e=>e>=1048576?e/1024/1024+" MB":e>=1024?e/1024+" KB":`${e} B`;function k(){const{toggleColorScheme:e}=(0,a.X)(),[t,r]=(0,m.useState)([]),[s,S]=(0,m.useState)({done:0,total:0}),[k,x]=(0,m.useState)({state:"idle",error:"",hash:""}),E=(0,f.c)({initialValues:{path:"",name:"",pieceLength:2**18,comment:"",source:"",private:!1,announceList:[],urlList:[],version:b.f.gitVersion}});(0,m.useEffect)((()=>{y.once("pass-from-window",(({payload:t})=>{console.log("Got from window",t);const{colorScheme:s,defaultTrackers:a}=JSON.parse(t.payload);e(s),r(a)})),T("pass_to_window",{to:"main",payload:"ready"})}),[e]);const{setFieldValue:D}=E,O=(0,m.useCallback)((()=>{v.dialog.open({title:"Select file",defaultPath:""===E.values.path?void 0:E.values.path,multiple:!1}).then((e=>{if(null===e)return;D("path",e);const t=e.split(/[\\/]/).pop()??"";D("name",t)})).catch(console.error)}),[E.values.path,D]),z=(0,m.useCallback)((()=>{v.dialog.open({title:"Select directory",defaultPath:""===E.values.path?void 0:E.values.path,directory:!0}).then((e=>{if(null===e)return;D("path",e);const t=e.split(/[\\/]/).pop()??"";D("name",t)})).catch(console.error)}),[E.values.path,D]),B=(0,m.useRef)(0),I=(0,m.useCallback)((()=>{T("create_torrent",{info:E.values}).then((()=>{clearInterval(B.current),B.current=window.setInterval((()=>{T("check_create_torrent").then((e=>{x({state:"generating",error:"",hash:""}),console.log("Check result",e),void 0!==e.error&&(x({state:"error",error:e.error,hash:""}),clearInterval(B.current)),void 0!==e.complete&&(x({state:"done",error:"",hash:e.complete}),clearInterval(B.current)),void 0!==e.notFound&&(x({state:"error",error:"Torrent create request not found on backend",hash:""}),clearInterval(B.current)),void 0!==e.inProgress&&S({done:e.inProgress.hashed,total:e.inProgress.total})})).catch((e=>{x({state:"error",error:e,hash:""}),clearInterval(B.current)}))}),500)})).catch((e=>{x({state:"error",error:e,hash:""})}))}),[E.values]),L=(0,m.useCallback)((()=>{clearInterval(B.current),T("cancel_create_torrent").then((()=>{x({state:"idle",error:"",hash:""})})).catch((e=>{x({state:"error",error:e,hash:""})}))}),[]),P=(0,m.useCallback)((()=>{v.dialog.save({title:"Save torrent file",filters:[{name:"Torrent",extensions:["torrent"]}]}).then((e=>{null!=e&&T("save_create_torrent",{path:e}).then((()=>{x({state:"idle",error:"",hash:""})})).catch((e=>{x({state:"error",error:e,hash:""})}))})).catch(console.error)}),[]),F=(0,m.useCallback)((()=>{let e=E.values.announceList;e=[...e,...t],E.setFieldValue("announceList",e)}),[t,E]);return m.createElement(n.k,{direction:"column",h:"100%",w:"100%",p:"lg",gap:"lg"},m.createElement(o.Z,{align:"flex-end"},m.createElement(i.o,{label:"Select file or folder",...E.getInputProps("path"),styles:{root:{flexGrow:1}}}),m.createElement(l.z,{onClick:O},"File"),m.createElement(l.z,{onClick:z},"Directory")),m.createElement(i.o,{label:"Torrent name",...E.getInputProps("name")}),m.createElement(c.x,{fz:"sm"},"Piece size"),m.createElement(u.i,{pt:"2.5rem",pb:"0.5rem",px:"1rem",scale:e=>2**e,step:1,min:14,max:28,labelAlwaysOn:!0,label:C,value:Math.log2(E.values.pieceLength),onChange:e=>{E.setFieldValue("pieceLength",2**e)}}),m.createElement(i.o,{label:"Comment",...E.getInputProps("comment")}),m.createElement(i.o,{label:"Source (leave empty unless required by a private tracker)",...E.getInputProps("source")}),m.createElement(h.X,{label:"Private torrent",...E.getInputProps("private",{type:"checkbox"})}),m.createElement(o.Z,{align:"flex-end"},m.createElement(d.x,{sx:{flexGrow:1}},"Tracker list, one per line, empty line between tiers"),m.createElement(l.z,{onClick:F},"Add default list")),m.createElement(p.g,{styles:w,value:E.values.announceList.join("\n"),onChange:e=>{E.setFieldValue("announceList",e.target.value.split("\n"))}}),m.createElement(p.g,{styles:w,label:"Web seed URLs, one per line",value:E.values.urlList.join("\n"),onChange:e=>{E.setFieldValue("urlList",e.target.value.split("\n"))}}),m.createElement(d.x,{h:"1.5rem"},"error"===k.state&&m.createElement(c.x,{color:"red"},k.error),"generating"===k.state&&m.createElement(g.k,{now:s.done,max:Math.max(s.total,1),label:`Hashing, done ${s.done} of ${s.total}`,animate:!0}),"done"===k.state&&m.createElement(c.x,null,`Torrent infohash: ${k.hash}`)),m.createElement(o.Z,{position:"center"},("idle"===k.state||"error"===k.state)&&m.createElement(l.z,{miw:"10rem",onClick:I},"Generate"),"generating"===k.state&&m.createElement(l.z,{miw:"10rem",onClick:L,color:"red"},"Cancel"),"done"===k.state&&m.createElement(l.z,{miw:"10rem",onClick:P,color:"green"},"Save")))}s()}catch(x){s(x)}}),1)},8913:(e,t,r)=>{r.a(e,(async(e,s)=>{try{r.d(t,{De:()=>S,Dk:()=>T,E_:()=>y,O0:()=>d,XS:()=>f,bb:()=>v,nF:()=>p});var a=r(7294),n=r(9362);const{readConfigText:e,writeConfigText:o}=await r.e(457).then(r.bind(r,4637)),i=["torrents","filetree","filetreebrief","trackers","peers"],l=["种子状态","数据目录","用户标签","服务器分布","错误分布"],c=["全部","下载中","已暂停","已完成","正在校验","活动中","未活动","工作中","错误","磁力链接"],u=["连接状态","下载速度","上传速度","剩余空间","列表总大小","选中大小"],h=["常规","文件","块","用户","Tracker","分割","数据统计"],d=["最小化","隐藏"],p=["隐藏","关闭","退出"],f=["默认关","默认开","记住选择"],v=["静态","动态","多颜色"],m={torrents:{sizeWhenDone:!1,leftUntilDone:!1,downloadedEver:!1,uploadedEver:!1,simpleRatio:!1,eta:!1,tracker:!1,trackerStatus:!1,doneDate:!1,activityDate:!1,downloadDir:!1,id:!1,queuePosition:!1,isPrivate:!1,group:!1,"file-count":!1,pieceCount:!1,metadataPercentComplete:!1},peers:{flagStr:!1,cachedFrom:!1,cachedConnection:!1,cachedProtocol:!1}},b=[],g={servers:[],app:{window:{size:[1024,800],position:void 0},openTabs:[],lastTab:0,deleteAdded:!1,toastNotifications:!0,toastNotificationSound:!0,showTrayIcon:!0,onMinimize:"最小化",onClose:"退出",fontSizeBase:.9,fontSize:.9},interface:{theme:void 0,tables:Object.fromEntries(i.map((e=>[e,{columns:[],columnVisibility:m[e]??{},columnOrder:[],columnSizes:{},sortBy:[]}]))),sashSizes:{vertical:[70,30],horizontal:[20,80]},filterSections:l.map((e=>({section:e,visible:!0}))),statusFiltersVisibility:Object.fromEntries(c.map((e=>[e,!["工作中","磁力链接"].includes(e)]))),compactDirectories:!1,hideSubDirTorrents:!1,showFilterGroupSize:!0,selectFilterGroupOnDbClk:!0,showRunStatus:!0,statusBarSections:u.map((e=>({section:e,visible:!0}))),statusBarGlobalSpeeds:!0,showFiltersPanel:!0,showDetailsPanel:!0,detailsTabs:h.map((e=>({section:e,visible:!0}))),showFilesSearchBox:!1,flatFileTree:!1,mainSplit:"vertical",skipAddDialog:!1,deleteTorrentData:"默认关",deleteTorrentDataSelection:!1,deleteTorrentDataWhenOneSelection:!1,numLastSaveDirs:20,sortLastSaveDirs:!1,preconfiguredLabels:[],defaultTrackers:[...b],styleOverrides:{dark:{},light:{}},progressbarStyle:"动态"}};class S{values=g;async read(){const t=(await r.e(202).then(r.bind(r,228))).default;try{const r=await e();t(this.values,JSON.parse(r));const s=this.values.interface.styleOverrides;void 0!==s.color&&(s[this.values.interface.theme??"light"].color=s.color,s.color=void 0),void 0!==s.backgroundColor&&(s[this.values.interface.theme??"light"].backgroundColor=s.backgroundColor,s.backgroundColor=void 0),void 0!==this.values.openTabs&&(this.values.app.openTabs=this.values.openTabs,this.values.openTabs=void 0)}catch(e){console.log(e)}this.values.app.openTabs=this.values.app.openTabs.filter((e=>void 0!==this.values.servers.find((t=>t.name===e)))),this.values.servers=this.values.servers.map((e=>({...e,connection:{...e.connection,password:(0,n.p4)(e.connection.password)}}))),this.values.app.lastTab>=this.values.app.openTabs.length&&(this.values.app.lastTab=-1);for(const e of l)this.values.interface.filterSections.find((t=>t.section==e))||this.values.interface.filterSections.push({section:e,visible:!0});this.values.interface.filterSections=this.values.interface.filterSections.filter((e=>l.indexOf(e.section)>=0));for(const e of h)this.values.interface.detailsTabs.find((t=>t.section==e))||this.values.interface.detailsTabs.push({section:e,visible:!0});this.values.interface.detailsTabs=this.values.interface.detailsTabs.filter((e=>h.indexOf(e.section)>=0));for(const e of u)this.values.interface.statusBarSections.find((t=>t.section==e))||this.values.interface.statusBarSections.push({section:e,visible:!0});return this.values.interface.statusBarSections=this.values.interface.statusBarSections.filter((e=>u.indexOf(e.section)>=0)),this}async save(){const e={...this.values};e.servers=e.servers.map((e=>({...e,connection:{...e.connection,password:(0,n.H6)(e.connection.password)}})));const t=JSON.stringify(e,null,"    ");await o(t)}getTheme(){return this.values.interface.theme}setTheme(e){this.values.interface.theme=e}getSashSizes(e){return this.values.interface.sashSizes[e]}setSashSizes(e,t){this.values.interface.sashSizes[e]=t}getServers(){return this.values.servers}getOpenServers(){return this.values.servers.filter((e=>this.values.app.openTabs.includes(e.name)))}setServers(e){this.values.servers=e}getServer(e){return this.values.servers.find((t=>t.name===e))}getOpenTabs(){return this.values.app.openTabs}getLastOpenTab(){return this.values.app.openTabs[this.values.app.lastTab]}setOpenTabs(e,t){this.values.app.openTabs=e,this.values.app.lastTab=t}setTableColumnSizes(e,t){this.values.interface.tables[e].columnSizes=t}getTableColumnSizes(e){return this.values.interface.tables[e].columnSizes}setTableColumnVisibility(e,t){this.values.interface.tables[e].columnVisibility=t}getTableColumnVisibility(e){return this.values.interface.tables[e].columnVisibility}setTableColumnOrder(e,t){this.values.interface.tables[e].columnOrder=t}getTableColumnOrder(e){return this.values.interface.tables[e].columnOrder}setTableSortBy(e,t){this.values.interface.tables[e].sortBy=t}getTableSortBy(e){return this.values.interface.tables[e].sortBy}addSaveDir(e,t){const r=this.removeSaveDir(e,t);if(void 0!==r)for(r.unshift(t);r.length>this.values.interface.numLastSaveDirs;)r.pop()}removeSaveDir(e,t){const r=this.getServer(e)?.lastSaveDirs;if(void 0===r)return;const s=r.findIndex((e=>e===t));return s>=0&&r.splice(s,1),r}}const y=a.createContext(new S),T=a.createContext({connection:{url:"",username:"",password:""},name:"",pathMappings:[],expandedDirFilters:[],lastSaveDirs:[],intervals:{session:0,torrents:0,torrentsMinimized:0,details:0}});s()}catch(e){s(e)}}),1)},9362:(e,t,r)=>{r.d(t,{DO:()=>k,H6:()=>T,Iy:()=>n,Nw:()=>c,QY:()=>p,Qh:()=>m,Tx:()=>g,V6:()=>b,dh:()=>l,e$:()=>i,jb:()=>v,kB:()=>f,l:()=>h,oU:()=>u,p4:()=>w,qj:()=>o,wy:()=>x});var s=r(7294);const a=["B","KB","MB","GB","TB","PB","EB"];function n(e){let t="",r=1;for(t of a){if(e<1024*r)break;r*=1024}const s=e/r;let n=2;return s>=100&&(n=1),s>=1e3&&(n=0),"B"===t&&(n=0),`${s.toFixed(n)} ${t}`}function o(e){return e<0?"∞":`${n(e)}/s`}function i(e,t=!0){let r={days:Math.floor(e/86400),hours:Math.floor(e/3600)%24,minutes:Math.floor(e/60)%60,seconds:e%60};t&&(r.days>=10?r={days:r.days,hours:0,minutes:0,seconds:0}:r.days>0?r={...r,minutes:0,seconds:0}:(r.days>0||r.hours>0)&&(r.seconds=0));let s="";return r.days>0&&(s=`${r.days}d`),r.hours>0&&(s=(""!==s?s+" ":"")+`${r.hours}h`),r.minutes>0&&(s=(""!==s?s+" ":"")+`${r.minutes}m`),r.seconds>0&&(s=(""!==s?s+" ":"")+`${r.seconds}s`),s}function l(e){return 0===e?"-":new Date(1e3*e).toLocaleString()}function c(e){if(0===e.length)return"";let t="/";return e.includes("\\")&&(t="\\"),e.charAt(e.length-1)!==t?e+t:e}function u(){const[,e]=(0,s.useReducer)((e=>e+1),0);return e}function h(e,t,r){const s=Array.from(e),[a]=s.splice(t,1);return s.splice(r,0,a),s}function d(e){return e.replace(/\\/g,"/")}function p(e,t){let r=e;const s=d(e);for(const e of t.pathMappings)if(e.from.length>0&&s.startsWith(d(e.from))){r=e.to+r.substring(e.from.length);break}return r}function f(e,t){let r=e;const s=d(e);for(const e of t.pathMappings)if(e.to.length>0&&s.startsWith(d(e.to))){r=e.from+r.substring(e.to.length);break}return r}function v(e){return navigator.platform.startsWith("Mac")&&e.metaKey||!navigator.platform.startsWith("Mac")&&e.ctrlKey}function m(){return navigator.platform.startsWith("Mac")?"⌘":"ctrl"}function b(e){const t=e.substring(8).split("&").map((e=>{const t=e.indexOf("=");return[e.substring(0,t),e.substring(t+1)]}));let r=t.find((e=>"xt"===e[0]))?.[1]??"";return r=r.startsWith("urn:btih:")?r.substring(9).toLowerCase():"",{hash:r,trackers:t.filter((e=>"tr"===e[0]&&""!==e[1])).map((e=>decodeURIComponent(e[1])))}}function g(e,t){const r=new Set;e.forEach((e=>{e.forEach((e=>r.add(e)))}));const s=[...e];return t.forEach(((e,t)=>{if(t>=s.length){const t=e.filter((e=>!r.has(e)));t.length>0&&(s.push(t),t.forEach((e=>r.add(e))))}else e.forEach((e=>{r.has(e)||(s[t].push(e),r.add(e))}))})),s}const S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",y="HfxgnvteJy86p0ZPDdIYmc5r[kOj9EowACSWG7is%VNBXMhKFa2UlL31bzu4RQTq:";function T(e){const t=btoa(encodeURIComponent("TrguiNG:"+e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})));let r="";for(const e of t)r+=y[S.indexOf(e)];return r}function w(e){let t="";for(const r of e){const s=y.indexOf(r);if(!(s>=0))return e;t+=S[s]}try{const s=(r=t,decodeURIComponent(Array.prototype.map.call(atob(r),(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")));return s.startsWith("TrguiNG:")?s.substring(8):e}catch{return e}var r}const C=/[<>:"\\/|?*]/g;function k(e){return e.replace(C,"_")}function*x(...e){for(const t of e)yield*t}}}]);